# Maps a Secrets Manager JSON secret to a K8s Secret.
# Secrets Manager value should be JSON like:
# {"username":"agentforge_db","password":"<STRONG_PASSWORD>","host":"agentforge-db-instance-1.c414...rds.amazonaws.com","port":"5432","dbname":"agentforge"}
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: agentforge-db-credentials
  namespace: agentforge-staging
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: aws-secrets-store
    kind: SecretStore
  target:
    name: agentforge-db
    creationPolicy: Owner
  dataFrom:
    - extract:
        key: <AWS_SECRETS_MANAGER_KEY_FOR_RDS_JSON>
---
